<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Eating Animals: The Math</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.7;
            color: #e2e8f0;
            background: linear-gradient(to bottom, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0.5rem 1.5rem 3rem 1.5rem;
        }
        
        h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #f8fafc;
            line-height: 1.2;
            text-align: center;
        }
        
        .subtitle {
            font-size: clamp(1rem, 2.5vw, 1.4rem);
            color: #94a3b8;
            font-style: italic;
            text-align: center;
            margin-bottom: 3rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        h2 {
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: 600;
            margin: 3rem 0 1rem 0;
            color: #f1f5f9;
            border-bottom: 2px solid #334155;
            padding-bottom: 0.5rem;
        }
        
        h3 {
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
            font-weight: 600;
            margin: 2rem 0 0.8rem 0;
            color: #cbd5e1;
        }
        
        p {
            margin-bottom: 1.2rem;
            font-size: clamp(0.95rem, 2vw, 1.1rem);
            color: #cbd5e1;
        }
        
        .hero-section {
            text-align: center;
            padding: 0;
            max-width: 900px;
            margin: 0 auto 1.5rem;
        }
        
        .hero-section p {
            color: #94a3b8;
            font-size: clamp(1rem, 2.2vw, 1.25rem);
        }
        
        .hero-highlight {
            color: #6ee7b7;
            font-weight: 600;
        }
        
        .problem-box {
            background: linear-gradient(135deg, #422006 0%, #292524 100%);
            border-left: 4px solid #fbbf24;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 12px;
        }
        
        .insight-box {
            background: linear-gradient(135deg, #064e3b 0%, #1e293b 100%);
            border-left: 4px solid #6ee7b7;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 12px;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #450a0a 0%, #292524 100%);
            border-left: 4px solid #f87171;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 12px;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .comparison-card {
            background: rgba(30, 41, 59, 0.3);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid rgba(51, 65, 85, 0.5);
            transition: all 0.3s ease;
        }
        
        .comparison-card:hover {
            transform: translateY(-2px);
            border-color: rgba(110, 231, 183, 0.4);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .comparison-title {
            font-weight: 600;
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: #6ee7b7;
        }
        
        .formula {
            background: #0f172a;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 12px;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            overflow-x: auto;
            border: 1px solid #334155;
            color: #6ee7b7;
        }
        
        .interactive-section {
            background: rgba(30, 41, 59, 0.3);
            padding: 2rem;
            margin: 3rem 0;
            border-radius: 12px;
            border: 1px solid rgba(51, 65, 85, 0.5);
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .control-group {
            background: rgba(15, 23, 42, 0.4);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #334155;
        }
        
        .slider-group {
            margin: 1.5rem 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            font-weight: 500;
            color: #e2e8f0;
        }
        
        .slider-value {
            background: #064e3b;
            color: #6ee7b7;
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.95rem;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #334155;
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #6ee7b7;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 0 8px rgba(110, 231, 183, 0.2);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #6ee7b7;
            cursor: pointer;
            border: none;
        }
        
        .filter-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin: 1.5rem 0;
        }
        
        .filter-pill {
            padding: 0.5rem 1.2rem;
            border-radius: 20px;
            border: 1px solid #334155;
            background: #1e293b;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        .filter-pill:hover {
            border-color: #6ee7b7;
            color: #6ee7b7;
        }
        
        .filter-pill.active {
            background: #6ee7b7;
            color: #0f172a;
            border-color: #6ee7b7;
        }
        
        .chart-container {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #0f172a;
            border-radius: 12px;
            border: 1px solid #334155;
        }
        
        .detail-panel {
            background: rgba(30, 41, 59, 0.3);
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid rgba(51, 65, 85, 0.5);
            margin: 2rem 0;
        }
        
        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #334155;
        }
        
        .detail-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #f1f5f9;
        }
        
        .detail-score {
            font-family: monospace;
            font-size: 1.3rem;
            color: #6ee7b7;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .metric-chip {
            background: rgba(15, 23, 42, 0.6);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(51, 65, 85, 0.4);
        }
        
        .metric-label {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.3rem;
        }
        
        .metric-value {
            font-family: monospace;
            font-size: 1.3rem;
            color: #e2e8f0;
            margin-bottom: 0.3rem;
        }
        
        .metric-hint {
            font-size: 0.7rem;
            color: #64748b;
            line-height: 1.4;
        }
        
        .decomposition-section {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: #0a0f1e;
            border-radius: 10px;
            border: 1px solid #1e293b;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: #1e293b;
            border-radius: 12px;
            overflow: hidden;
        }
        
        th, td {
            padding: 0.8rem;
            text-align: left;
            border-bottom: 1px solid #334155;
            font-size: clamp(0.75rem, 1.8vw, 0.95rem);
        }
        
        th {
            background: #0f172a;
            font-weight: 600;
            color: #94a3b8;
            font-size: clamp(0.7rem, 1.8vw, 0.85rem);
        }
        
        tr:hover {
            background: #0f172a;
        }
        
        .emphasis {
            font-weight: 600;
            color: #6ee7b7;
        }
        
        code {
            background: #0f172a;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
            color: #6ee7b7;
        }
        
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1.5rem;
            color: #cbd5e1;
        }
        
        li {
            margin-bottom: 0.6rem;
        }
        
        .section-divider {
            height: 2px;
            background: linear-gradient(to right, transparent, #334155, transparent);
            margin: 4rem 0;
        }
        
        .closing-reflection {
            max-width: 800px;
            margin: 3rem auto;
            padding: 2rem;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-radius: 16px;
            border: 1px solid #334155;
            text-align: center;
        }

        .preset-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.8rem;
            flex-wrap: wrap;
        }

        .preset-btn {
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            border: 1px solid #334155;
            background: #1e293b;
            color: #94a3b8;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            border-color: #6ee7b7;
            color: #6ee7b7;
        }

        .preset-btn.active {
            background: #064e3b;
            border-color: #6ee7b7;
            color: #6ee7b7;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1.5rem 1rem;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 400px !important;
            }
            
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            
            .formula {
                font-size: 0.85rem;
                padding: 1rem;
            }
            
            .formula > div:first-child {
                font-size: 1.1em !important;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-pills {
                justify-content: center;
            }
            
            .filter-pill {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .detail-panel {
                padding: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 1rem 0.75rem;
            }
            
            .chart-container {
                height: 350px !important;
            }
            
            .interactive-section {
                padding: 1.5rem;
            }
            
            .control-group {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.75rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="hero-section">
            <h1>Eating Animals: The Math</h1>
            <p class="subtitle">If you care about reducing suffering but aren't willing to be vegetarian, what should you eat? The obvious answers are wrong.</p>
            <p style="font-size: 0.9rem; color: #64748b; margin-top: 1rem;">by Cameron Berg</p>
        </div>
        
        <h2>The Problem with Simple Rules</h2>
        
        <p>If you're like me and you eat animals but want to reduce harm, you probably use one of two intuitive heuristics:</p>
        
        <div class="comparison-grid">
            <div class="comparison-card">
                <div class="comparison-title">Heuristic #1: Complexity</div>
                <p>"Eat simpler animals that have less complex conscious experience."</p>
                <p style="margin-top: 1em; color: #64748b;">Intuition: A chicken probably suffers less than a cow, so chicken is more ethical.</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">Heuristic #2: Death Count</div>
                <p>"Eat creatures that give you more meals per death."</p>
                <p style="margin-top: 1em; color: #64748b;">Intuition: One cow feeds you for a year; one chicken gives you ~10 meals. Minimize kill count.</p>
            </div>
        </div>
        
        <div class="problem-box">
            <strong style="color: #fbbf24;">The Problem:</strong> These heuristics point in opposite directions. If you follow #1, you eat lots of small animals. If you follow #2, you eat large complex animals. <span class="hero-highlight">Which is actually less harmful?</span>
        </div>
        
        <p>The answer requires a formal model that weighs multiple factors simultaneously. But first, let's be honest about what this model actually does.</p>
        
        <h2>What This Model Actually Does</h2>
        
        <div class="insight-box">
            <p><strong style="color: #6ee7b7;">Fair warning:</strong> This model is going to tell you that the number of individuals you eat matters more than almost anything else. If you're eating 35 chickens per year vs 0.3 cows, that 100× difference in kill count dominates the 2× difference in consciousness.</p>
            
            <p style="margin-top: 1rem;">So why build a formal model? Because:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li>Most people don't naturally track individuals-per-meal. We think in "meals" not "fractional animals"</li>
                <li>The consciousness adjustments (I×T) matter for edge cases like shrimp</li>
                <li>The aggregation question (γ) determines whether many-small-deaths or few-large-deaths is worse</li>
                <li>It quantifies how much sourcing matters relative to species choice</li>
            </ul>
            
            <p style="margin-top: 1rem;"><strong>If you just want the bottom line:</strong> Eat large animals, avoid crustaceans. The model helps you see why and lets you tune your moral assumptions.</p>
        </div>
        
        <h2>What Are We Actually Measuring?</h2>
        
        <p>The harm of eating an animal isn't just about the moment of death. It's the <span class="emphasis">total moral weight of everything that animal experiences</span> multiplied by how many such animals your diet burns through:</p>
        
        <div class="comparison-grid">
            <div class="comparison-card">
                <div class="comparison-title">Lifetime Suffering (L)</div>
                <p>The area under the curve of chronic stress, pain, confinement, and deprivation throughout life.</p>
                <p style="margin-top: 1em; color: #64748b; font-size: 0.9rem;">L decomposes into: <strong>physical suffering</strong> + <strong>psychological stress</strong> + <strong>social deprivation</strong></p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">Death Suffering</div>
                <p>Both the pain of dying (suffocation vs. stunning) and the loss of future positive experiences.</p>
                <p style="margin-top: 1em; color: #64748b; font-size: 0.9rem;">D_process (how painful) + D_deprivation (what's lost)</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">Experience Quality</div>
                <p>Not all experiences are equally rich. We model this through <strong>intensity</strong> (how strongly pain/pleasure is felt) and <strong>temporal depth</strong> (how experiences echo through memory and anticipation).</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">Number of Individuals (N)</div>
                <p><strong>This is the key parameter.</strong> One chicken yields ~10 portions (5oz each), so N=0.096 per meal. One cow yields ~1,280 portions, so N=0.0008 per meal. That's a 120× difference that overwhelms most other factors.</p>
            </div>
        </div>
        
        <div class="insight-box">
            <strong style="color: #6ee7b7;">Key insight:</strong> These factors interact multiplicatively. The consciousness quality factors (I×T) vary by ~10× across species. But N varies by ~10,000×. So N dominates ~95% of the variance in harm.
        </div>
        
        <h2>The Formal Model</h2>
        
        <p>We can express the total harm of eating a species as:</p>
        
        <div class="formula">
<div style="font-size: 1.4em; margin-bottom: 1.5rem; color: #6ee7b7; line-height: 1.6;">
H = <span style="color: #fbbf24;">N^γ</span> × <span style="color: #3b82f6;">(I × T)</span> × <span style="color: #6ee7b7;">(α·L + β·D_process + δ·D_deprivation)</span>
</div>

<div style="margin-bottom: 1.5rem;">
<div style="padding: 1rem; background: rgba(251, 191, 36, 0.1); border-left: 3px solid #fbbf24; border-radius: 6px; margin-bottom: 0.8rem;">
<strong style="color: #fbbf24;">How many individuals per meal?</strong> <span style="color: #cbd5e1;">N^γ</span>
<div style="font-size: 0.9em; color: #94a3b8; margin-top: 0.3rem;">Based on standardized 5-6oz portions. One chicken = 10 portions, one cow = 1,280 portions.</div>
</div>

<div style="padding: 1rem; background: rgba(59, 130, 246, 0.1); border-left: 3px solid #3b82f6; border-radius: 6px; margin-bottom: 0.8rem;">
<strong style="color: #3b82f6;">What kind of minds?</strong> <span style="color: #cbd5e1;">I × T</span>
<div style="font-size: 0.9em; color: #94a3b8; margin-top: 0.3rem;">Intensity (how strongly felt) × Temporal depth (how it echoes through time)</div>
</div>

<div style="padding: 1rem; background: rgba(110, 231, 183, 0.1); border-left: 3px solid #6ee7b7; border-radius: 6px;">
<strong style="color: #6ee7b7;">What happens to those minds?</strong> <span style="color: #cbd5e1;">α·L + β·D_process + δ·D_deprivation</span>
<div style="font-size: 0.9em; color: #94a3b8; margin-top: 0.3rem;">Lifetime suffering + pain of dying + loss of future, each weighted by what you care about</div>
</div>
</div>

<details style="cursor: pointer; color: #94a3b8;">
<summary style="font-size: 0.95rem; margin-bottom: 0.5rem; cursor: pointer;">▸ See all parameter definitions</summary>
<div style="display: grid; grid-template-columns: auto 1fr; gap: 0.5rem 1rem; font-size: 0.9rem; margin-top: 1rem; padding-left: 1rem;">
<strong>H</strong> <span style="color: #cbd5e1;">Total moral harm per meal</span>
<strong>N</strong> <span style="color: #cbd5e1;">Individuals consumed per meal (based on 5-6oz portions)</span>
<strong>γ</strong> <span style="color: #cbd5e1;">Aggregation exponent (1.0 = linear, &lt;1.0 = diminishing, &gt;1.0 = accelerating)</span>
<strong>I</strong> <span style="color: #cbd5e1;">Intensity of valenced experience (0–1)</span>
<strong>T</strong> <span style="color: #cbd5e1;">Temporal depth: memory, anticipation, integration (0–1)</span>
<strong>L</strong> <span style="color: #cbd5e1;">Lifetime suffering (0–3) = ω_phys·L_phys + ω_psych·L_psych + ω_social·L_social</span>
<strong>D_process</strong> <span style="color: #cbd5e1;">Pain of dying (0–3)</span>
<strong>D_deprivation</strong> <span style="color: #cbd5e1;">Loss of future value (0–3)</span>
<strong>α, β, δ</strong> <span style="color: #cbd5e1;">Moral weights: how much you care about lifetime vs. death process vs. deprivation</span>
<strong>ω</strong> <span style="color: #cbd5e1;">Suffering type weights: how much you care about physical vs. psychological vs. social harms</span>
</div>
</details>
        </div>
        
        <p>This approximates the structure of what matters:</p>
        
        <ul>
            <li>The product <code style="color: #3b82f6;">N^γ × I × T</code> accounts for quantity and quality of minds, with γ controlling whether numbers scale linearly</li>
            <li>Splitting experience into <strong>intensity</strong> and <strong>temporal depth</strong> recognizes that suffering persisting through memory matters differently than momentary pain</li>
            <li>Decomposing death into <strong>process</strong> and <strong>deprivation</strong> separates "bad dying" from "foreclosed futures"</li>
            <li>The weights let you encode what you care about most</li>
        </ul>
        
        <p><strong>Critical note:</strong> With default parameters (γ=1, all weights ~1), this reduces to approximately: H ≈ N × (consciousness quality) × (suffering factors). Since N varies by 10,000× and consciousness varies by ~10×, <span class="emphasis">N dominates everything</span>. The model's value isn't complexity—it's making this calculation explicit.</p>
        
        <h2>Understanding the Parameters</h2>
        
        <p>The model has several parameters you can tune. Here's what they mean and how to think about them:</p>
        
        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ Calculating N (Individuals Per Meal)</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <p><strong>N is based on standardized 5-6oz protein portions.</strong> This is the arithmetic that drives the entire model:</p>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Chicken:</strong><br>
                    Live weight: 5 lbs<br>
                    × Meat yield: 65% = 3.25 lbs = 52 oz<br>
                    ÷ Portion size: 5 oz<br>
                    = 10.4 portions per chicken<br>
                    <strong style="color: #fbbf24;">→ N = 1/10.4 = 0.096</strong>
                    </p>
                </div>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Pig:</strong><br>
                    Live weight: 280 lbs<br>
                    × Meat yield: 60% = 168 lbs = 2,688 oz<br>
                    ÷ Portion size: 5 oz<br>
                    = 538 portions per pig<br>
                    <strong style="color: #fbbf24;">→ N = 1/538 = 0.002</strong>
                    </p>
                </div>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Cow (Beef):</strong><br>
                    Live weight: 1,200 lbs<br>
                    × Meat yield: 40% = 480 lbs = 7,680 oz<br>
                    ÷ Portion size: 6 oz<br>
                    = 1,280 portions per cow<br>
                    <strong style="color: #fbbf24;">→ N = 1/1,280 = 0.0008</strong>
                    </p>
                </div>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Shrimp:</strong><br>
                    Typical serving: 15 shrimp<br>
                    <strong style="color: #fbbf24;">→ N = 15</strong>
                    </p>
                </div>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Salmon:</strong><br>
                    Live weight: 10 lbs<br>
                    × Meat yield: 60% = 6 lbs = 96 oz<br>
                    ÷ Portion size: 6 oz<br>
                    = 16 portions per salmon<br>
                    <strong style="color: #fbbf24;">→ N = 1/16 = 0.0625</strong>
                    </p>
                </div>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Large Tuna:</strong><br>
                    Live weight: 200 lbs<br>
                    × Meat yield: 50% = 100 lbs = 1,600 oz<br>
                    ÷ Portion size: 5 oz<br>
                    = 320 portions per tuna<br>
                    <strong style="color: #fbbf24;">→ N = 1/320 = 0.003</strong>
                    </p>
                </div>
                
                <p style="margin-top: 1.5rem;"><strong>For products (eggs, dairy, honey):</strong> N is calculated based on annual production per animal divided by consumption per meal, accounting for culling rates.</p>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Eggs:</strong><br>
                    1 hen lays ~300 eggs/year<br>
                    Consumption: 2 eggs per meal<br>
                    = 150 meals per hen per year<br>
                    <strong style="color: #fbbf24;">→ N = 1/150 ≈ 0.007</strong>
                    </p>
                </div>
                
                <div style="background: #0a0f1e; padding: 1rem; border-radius: 8px; margin: 1rem 0; border: 1px solid #1e293b;">
                    <p style="font-family: monospace; font-size: 0.9rem; line-height: 1.8;">
                    <strong style="color: #6ee7b7;">Dairy:</strong><br>
                    1 cow produces ~48,000 cups milk/year<br>
                    Consumption: 1 cup per meal<br>
                    (Adjusted for culling and calf mortality)<br>
                    <strong style="color: #fbbf24;">→ N ≈ 0.0005</strong>
                    </p>
                </div>
                
                <p style="margin-top: 1.5rem; padding: 1rem; background: rgba(251, 191, 36, 0.1); border-left: 3px solid #fbbf24; border-radius: 6px;">
                <strong>Why this matters:</strong> When people think "I'm having chicken for dinner," they don't think "I'm consuming 0.096 chickens." But that's the actual arithmetic. Over a year of daily chicken meals, you kill 35 chickens. Over a year of daily beef meals, you kill 0.3 cows. That 117× difference in kill count is the core driver of the model.
                </p>
            </div>
        </details>

        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ Intensity (I) & Temporal Depth (T)</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <p>Instead of a single "consciousness" score, we separate two aspects of experience:</p>
                
                <ul style="margin-left: 1.5rem; margin-top: 0.8rem;">
                    <li><strong>I (Intensity):</strong> How strongly valenced states are felt in the moment—based on nociceptor density, neural response to pain/pleasure stimuli</li>
                    <li><strong>T (Temporal Depth):</strong> How experiences propagate through time via memory, anticipation, rumination—based on hippocampal structures, learning integration</li>
                </ul>
                
                <p style="margin-top: 1rem;">A shrimp might have moderate intensity (pain receptors fire hard) but low temporal depth (minimal carry-forward). A cow has both high intensity and high temporal depth (suffering echoes for days).</p>
            </div>
        </details>

        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ Aggregation Exponent (γ) - The Critical Question</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <p>This controls how moral harm scales with numbers, and it's the most philosophically important parameter in the model:</p>
                
                <ul style="margin-left: 1.5rem; margin-top: 0.8rem;">
                    <li><strong>γ < 1.0 (diminishing returns):</strong> Each additional death matters less—perhaps because the <em>existence</em> of suffering minds has special moral weight beyond quantity</li>
                    <li><strong>γ = 1.0 (linear):</strong> Standard total utilitarianism—all suffering counts equally regardless of how it's distributed</li>
                    <li><strong>γ > 1.0 (accelerating):</strong> Mass deaths are disproportionately worse—perhaps because large-scale suffering has systemic/relational harms beyond individual experience</li>
                </ul>
                
                <p style="margin-top: 1rem;"><strong>Why this matters:</strong> If γ=1.0, eating 15 shrimp (with I×T=0.14 each) is genuinely worse than eating 1 chicken (I×T=0.42). If γ=0.7, shrimp drops significantly in harm. This is an open ethical question, not a settled fact.</p>
            </div>
        </details>

        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ Death Components (D_process & D_deprivation)</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <ul style="margin-left: 1.5rem;">
                    <li><strong>D_process:</strong> The suffering during dying—suffocation, stunning failure, prolonged consciousness</li>
                    <li><strong>D_deprivation:</strong> The loss of future value—preference frustration, foreclosed experiences. Scaled by lifespan and potential for positive states</li>
                </ul>
                
                <p style="margin-top: 1rem;">These aren't the same. A cow might die painlessly (low D_process) but lose years of grazing (high D_deprivation). A shrimp might die agonizingly (high D_process) but have minimal future to lose (low D_deprivation).</p>
            </div>
        </details>

        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ Lifetime Suffering Weights (ω_phys, ω_psych, ω_social)</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <p>Lifetime suffering (L) is composed of three types:</p>
                
                <ul style="margin-left: 1.5rem; margin-top: 0.8rem;">
                    <li><strong>Physical (L_phys):</strong> Injury, illness, chronic pain, physical discomfort</li>
                    <li><strong>Psychological (L_psych):</strong> Stress, fear, frustration, inability to express natural behaviors</li>
                    <li><strong>Social (L_social):</strong> Isolation, broken bonds, thwarted attachment, loss of group membership</li>
                </ul>
                
                <p style="margin-top: 1rem;">Each species has raw scores for these three types based on their typical living conditions. The ω weights let you express <em>your</em> moral priorities: maybe you think physical pain matters 2× more than social isolation, or maybe you think psychological stress is the core harm.</p>
                
                <p style="margin-top: 1rem;">The combined lifetime suffering is: <strong>L = ω_phys × L_phys + ω_psych × L_psych + ω_social × L_social</strong></p>
                
                <p style="margin-top: 1rem;">Try the presets in the interactive section to see how different priorities reshape the rankings.</p>
            </div>
        </details>
        
        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ How We Estimated I and T</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <p><strong>I (Intensity)</strong> is based on:</p>
                <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                    <li>Nociceptor density and neural architecture</li>
                    <li>Behavioral responses to aversive stimuli</li>
                    <li>Opioid receptor systems (markers of pain processing)</li>
                    <li>Evidence of pleasure/reward seeking</li>
                </ul>
                
                <p style="margin-top: 1rem;"><strong>T (Temporal Depth)</strong> is based on:</p>
                <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                    <li>Hippocampal structures (memory formation)</li>
                    <li>Evidence of anticipation and planning</li>
                    <li>Long-term behavioral modification from single events</li>
                    <li>Social learning and memory retention</li>
                </ul>
                
                <p style="margin-top: 1rem;">Cows/pigs: high I and T (rich momentary experience + long temporal integration). Fish: moderate I, variable T. Shrimp: moderate I, low T.</p>
            </div>
        </details>
        
        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ Relationship to Rethink Priorities' Welfare Range Estimates</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <p>Our framework is informed by <a href="https://rethinkpriorities.org/research-area/welfare-range-estimates" style="color: #6ee7b7;">Rethink Priorities' Moral Weight Project</a> but differs in approach:</p>
                
                <p style="margin-top: 1rem;"><strong>What RP measured:</strong> Peak pleasure minus peak pain intensity (conditional on sentience), for discrete welfare interventions. Pigs: 0.515, chickens: 0.332, salmon: 0.056.</p>
                
                <p style="margin-top: 1rem;"><strong>What we measure:</strong> Experiential intensity × temporal integration, for chronic welfare assessment in dietary contexts. Pigs: I=0.85, T=0.95. Chickens: I=0.70, T=0.60. Salmon: I=0.55, T=0.45.</p>
                
                <p style="margin-top: 1rem;"><strong>Why we differ:</strong> When assessing lifetime suffering, what matters isn't just peak intensity in a single moment, but how suffering accumulates and integrates over weeks and months. Our I×T product captures this differently than RP's welfare ranges, which are optimized for comparing point interventions rather than chronic conditions.</p>
                
                <p style="margin-top: 1rem;">Both approaches are legitimate; they're answering different questions with different tools.</p>
            </div>
        </details>

        <details style="background: rgba(30, 41, 59, 0.3); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; border: 1px solid rgba(51, 65, 85, 0.5); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor='rgba(110, 231, 183, 0.3)'" onmouseout="this.style.borderColor='rgba(51, 65, 85, 0.5)'">
            <summary style="font-weight: 600; font-size: 1.1rem; color: #f1f5f9; cursor: pointer;">▸ How Uncertainty Bands Work</summary>
            <div style="margin-top: 1rem; color: #cbd5e1;">
                <p>Click "Show Uncertainty" to see ranges around each H estimate. These aren't pulled from thin air—they reflect genuine epistemic uncertainty about the parameters:</p>
                
                <p style="margin-top: 1rem;"><strong>For I and T:</strong> We provide low/mid/high estimates based on uncertainty in neuroscience. For example, shrimp I could plausibly be 0.38 (minimal integration) to 0.58 (surprisingly rich nociception). The ranges reflect where empirical evidence is ambiguous.</p>
                
                <p style="margin-top: 1rem;"><strong>For N:</strong> Small variations based on meal size and preparation. A "shrimp meal" could be 10-20 shrimp depending on the dish.</p>
                
                <p style="margin-top: 1rem;"><strong>For L components:</strong> We apply ±20% to account for variation within production systems. Not all "industrial chicken" farms are equally bad; not all "pasture-raised" operations are equally good.</p>
                
                <p style="margin-top: 1rem;"><strong>Combined effect:</strong> These uncertainties propagate through the multiplication to give you ranges. The ranges show you how robust the rankings are. If two species' ranges overlap substantially, the ordering between them is genuinely uncertain.</p>
            </div>
        </details>
        
        <h2>Species Choice Matters More Than Sourcing</h2>
        
        <p>Here's a counterintuitive finding: <span class="emphasis">sourcing improvements only give you 25-35% reductions in harm, while species choice can give you 10-100× differences</span>. If you're eating industrial chicken and wondering whether to switch to pasture chicken or to grass-fed beef, the math says: switch species first, then optimize within it.</p>
        
        <div class="comparison-grid">
            <div class="comparison-card">
                <div class="comparison-title">Within Chicken: 35% Improvement</div>
                <p><strong>Industrial:</strong> H = 0.187<br>
                <strong>Pasture:</strong> H = 0.123</p>
                <p style="margin-top: 1em; color: #64748b;">Sourcing reduces L by ~55%, which translates to 35% better. Meaningful, but N=0.096 still dominates.</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">Chicken → Beef: 99% Improvement</div>
                <p><strong>Industrial Chicken:</strong> H = 0.187<br>
                <strong>Grass-Fed Beef:</strong> H = 0.001</p>
                <p style="margin-top: 1em; color: #64748b;">Species change drops N from 0.096 to 0.0008. This overwhelms all other factors—it's a 120× difference in kill count.</p>
            </div>
        </div>
        
        <div class="comparison-grid">
            <div class="comparison-card">
                <div class="comparison-title">Within Beef: 35% Improvement</div>
                <p><strong>Feedlot:</strong> H = 0.002<br>
                <strong>Grass-Fed:</strong> H = 0.001</p>
                <p style="margin-top: 1em; color: #64748b;">Same L reduction as chicken (~55%), same proportional improvement (~35%).</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">But Both Beat All Poultry</div>
                <p><strong>Feedlot Beef:</strong> H = 0.002<br>
                <strong>Pasture Chicken:</strong> H = 0.123</p>
                <p style="margin-top: 1em; color: #64748b;">Even the worst beef beats the best chicken by 62×. N=0.0008 is that powerful.</p>
            </div>
        </div>
        
        <div class="insight-box">
            <strong style="color: #6ee7b7;">Bottom line:</strong> Sourcing is second-order optimization. Get the species right first (low N), then optimize sourcing (low L). Don't spend energy finding the perfect pasture chicken farm when switching to wild-caught tuna would give you 3× the improvement.
        </div>
        
        <div class="section-divider"></div>
        
        <h2>Interactive Model Explorer</h2>
        
        <div class="interactive-section">
            <h3 style="margin-top: 0; color: #f1f5f9;">Adjust Your Moral Weights</h3>
            <p>What do you care about most? Tune the weights to match your intuitions and watch the moral landscape reshuffle:</p>
            
            <div class="controls-grid">
                <div class="control-group">
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Lifetime Suffering Weight (α)</span>
                            <span class="slider-value" id="alpha-value">1.0</span>
                        </div>
                        <input type="range" id="alpha-slider" min="0" max="2" step="0.1" value="1.0">
                        <p style="font-size: 0.85rem; color: #64748b; margin-top: 0.8rem;">Chronic pain, confinement stress, social isolation</p>
                    </div>
                    
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Death Process Weight (β)</span>
                            <span class="slider-value" id="beta-value">0.7</span>
                        </div>
                        <input type="range" id="beta-slider" min="0" max="2" step="0.1" value="0.7">
                        <p style="font-size: 0.85rem; color: #64748b; margin-top: 0.8rem;">Suffering during dying (suffocation, stunning failure)</p>
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Death Deprivation Weight (δ)</span>
                            <span class="slider-value" id="delta-value">0.3</span>
                        </div>
                        <input type="range" id="delta-slider" min="0" max="2" step="0.1" value="0.3">
                        <p style="font-size: 0.85rem; color: #64748b; margin-top: 0.8rem;">Loss of future positive experiences</p>
                    </div>
                </div>
                
                <div class="control-group">
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Aggregation Exponent (γ)</span>
                            <span class="slider-value" id="gamma-value">1.0</span>
                        </div>
                        <input type="range" id="gamma-slider" min="0.5" max="1.5" step="0.1" value="1.0">
                        <p style="font-size: 0.85rem; color: #64748b; margin-top: 0.8rem;">How harm scales with numbers: &lt;1.0 = diminishing returns, 1.0 = linear, &gt;1.0 = accelerating</p>
                    </div>

                    <h4 style="margin-top: 1.5rem; margin-bottom: 0.8rem; color: #cbd5e1; font-size: 1rem;">Lifetime Suffering Weights</h4>
                    
                    <div class="slider-group" style="margin-top: 1rem;">
                        <div class="slider-label">
                            <span>Physical (ω_phys)</span>
                            <span class="slider-value" id="omega-phys-value">1.0</span>
                        </div>
                        <input type="range" id="omega-phys-slider" min="0.3" max="2" step="0.1" value="1.0">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Psychological (ω_psych)</span>
                            <span class="slider-value" id="omega-psych-value">1.0</span>
                        </div>
                        <input type="range" id="omega-psych-slider" min="0.3" max="2" step="0.1" value="1.0">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Social (ω_social)</span>
                            <span class="slider-value" id="omega-social-value">1.0</span>
                        </div>
                        <input type="range" id="omega-social-slider" min="0.3" max="2" step="0.1" value="1.0">
                    </div>

                    <div class="preset-buttons">
                        <button class="preset-btn active" data-preset="balanced">Balanced</button>
                        <button class="preset-btn" data-preset="physical">Physical Priority</button>
                        <button class="preset-btn" data-preset="social">Social Priority</button>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <h3 style="color: #f1f5f9;">Filter by Category</h3>
                <div class="filter-pills">
                    <div class="filter-pill active" data-group="all">All Foods</div>
                    <div class="filter-pill" data-group="Seafood">Seafood</div>
                    <div class="filter-pill" data-group="Bird">Birds</div>
                    <div class="filter-pill" data-group="Mammal">Mammals</div>
                    <div class="filter-pill" data-group="Products">Products (Eggs/Dairy/Honey)</div>
                    <div class="filter-pill" data-group="Frontier">Frontier Foods</div>
                </div>
                
                <div style="margin-top: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button id="scale-toggle" style="padding: 0.6rem 1.2rem; border-radius: 8px; border: 2px solid #6ee7b7; background: #064e3b; color: #6ee7b7; cursor: pointer; font-size: 0.95rem; font-weight: 600; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                        Switch to Log Scale
                    </button>
                    <button id="uncertainty-toggle" style="padding: 0.6rem 1.2rem; border-radius: 8px; border: 2px solid #6ee7b7; background: #064e3b; color: #6ee7b7; cursor: pointer; font-size: 0.95rem; font-weight: 600; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                        Show Uncertainty
                    </button>
                </div>
            </div>
            
            <div class="chart-container" style="height: 700px;">
                <canvas id="harmChart"></canvas>
            </div>
            
            <p style="font-size: 0.85rem; color: #64748b; margin-top: 1rem;">Click any bar to see how that species' harm score decomposes into its underlying components. Uncertainty bands show sensitivity to parameter estimates.</p>
        </div>
        
        <div id="detail-panel" class="detail-panel" style="display: none;">
            <div class="detail-header">
                <div class="detail-title" id="detail-species-name">Wild Salmon</div>
                <div class="detail-score">H = <span id="detail-h">0.039</span> <span id="detail-range" style="color: #94a3b8; font-size: 0.9rem;"></span></div>
            </div>
            
            <p style="color: #94a3b8; margin-bottom: 1.5rem;">Group: <span id="detail-group" style="color: #6ee7b7; font-weight: 600;">Seafood</span></p>
            
            <div class="metrics-grid">
                <div class="metric-chip">
                    <div class="metric-label">Intensity (I)</div>
                    <div class="metric-value" id="detail-I">0.55</div>
                    <div class="metric-hint">Strength of valenced experience</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-label">Temporal Depth (T)</div>
                    <div class="metric-value" id="detail-T">0.45</div>
                    <div class="metric-hint">Memory, anticipation, integration</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-label">Lifetime Suffering (L)</div>
                    <div class="metric-value" id="detail-L">0.8</div>
                    <div class="metric-hint">Total chronic suffering across life</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-label">Death Process</div>
                    <div class="metric-value" id="detail-D-process">2.0</div>
                    <div class="metric-hint">Pain during dying</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-label">Death Deprivation</div>
                    <div class="metric-value" id="detail-D-deprivation">1.0</div>
                    <div class="metric-hint">Loss of future value</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-label">Individuals (N)</div>
                    <div class="metric-value" id="detail-N">0.0625</div>
                    <div class="metric-hint">Individuals per meal</div>
                </div>
            </div>
            
            <div class="decomposition-section">
                <h3 style="margin-top: 0; font-size: 1rem; color: #94a3b8;">Lifetime Suffering Breakdown (L)</h3>
                <div class="metrics-grid" style="margin-top: 1rem;">
                    <div class="metric-chip">
                        <div class="metric-label">Physical</div>
                        <div class="metric-value" id="detail-L-phys">0.3</div>
                        <div class="metric-hint">Injury, illness, chronic pain</div>
                    </div>
                    <div class="metric-chip">
                        <div class="metric-label">Psychological</div>
                        <div class="metric-value" id="detail-L-psych">0.3</div>
                        <div class="metric-hint">Stress, fear, thwarted behaviors</div>
                    </div>
                    <div class="metric-chip">
                        <div class="metric-label">Social</div>
                        <div class="metric-value" id="detail-L-social">0.2</div>
                        <div class="metric-hint">Isolation, broken bonds</div>
                    </div>
                </div>
            </div>
            
            <p id="detail-description" style="color: #cbd5e1; font-size: 0.95rem; margin-top: 1.5rem; line-height: 1.7; padding: 1rem; background: #0a0f1e; border-radius: 8px; border: 1px solid #1e293b;"></p>
        </div>
        
        <h2>The Results</h2>
        
        <p>When we apply the model with reasonable parameters, several non-obvious patterns emerge:</p>
        
        <div class="warning-box">
            <h3 style="margin-top: 0; color: #f87171;">1. Shrimp is Catastrophically Bad (H = 10.1)</h3>
            <p>Even though shrimp have lower experience quality (I×T = 0.14) than chickens (I×T = 0.42), you consume 15 per meal vs 0.096 chickens. They also die horrifically—often boiled alive. The numbers overwhelm the consciousness difference by orders of magnitude.</p>
            <p><strong>If you accept linear aggregation (γ=1), shrimp is 54× worse than chicken.</strong> If you think aggregation has diminishing returns (γ=0.7), shrimp drops to ~6, which is still 32× worse than chicken.</p>
            <p>This is the model's most controversial claim. It hinges on whether you think suffering scales linearly with numbers.</p>
        </div>
        
        <div class="insight-box">
            <h3 style="margin-top: 0; color: #6ee7b7;">2. All Mammals Beat All Poultry—Even Industrial vs Pasture</h3>
            <p>This is the model's strongest and most actionable finding. Even <strong>industrial pork</strong> (I×T=0.81, L=2.4, N=0.002) beats <strong>pasture chicken</strong> (I×T=0.42, L=1.2, N=0.096) by 18×.</p>
            
            <p style="margin-top: 1rem;">Why? One pig yields 538 portions. One chicken yields 10 portions. That's a 54× difference in kill count. Even though pigs are twice as conscious and suffer twice as much in industrial farms, the arithmetic overwhelms it.</p>
            
            <p style="margin-top: 1rem;"><strong>Over a year:</strong> If you eat one meat meal daily, the chicken path kills 35 birds (consciousness-weighted: 14.7 units) while the pork path kills 0.7 pigs (consciousness-weighted: 0.6 units). That's a 25× difference.</p>
            
            <p style="margin-top: 1rem;">The "eat smaller animals" heuristic is completely backwards if numbers matter.</p>
        </div>
        
        <div class="insight-box">
            <h3 style="margin-top: 0; color: #6ee7b7;">3. Beef is the Best Meat (H = 0.001-0.002)</h3>
            <p>Cows have rich conscious lives (I×T = 0.68), but you only consume 0.0008 cows per meal. One cow yields 1,280 portions—literally 3.5 years of daily beef meals. This absolutely dominates.</p>
            
            <p style="margin-top: 1rem;">Even <strong>feedlot beef</strong> (H = 0.002) beats <strong>pasture chicken</strong> (H = 0.123) by 62×. Grass-fed beef (H = 0.001) is 187× better than industrial chicken.</p>
            
            <p style="margin-top: 1rem;">If you eat meat and want to minimize harm: <strong>beef should be your default, then large fish, then pork, then poultry</strong>.</p>
        </div>

        <div class="insight-box">
            <h3 style="margin-top: 0; color: #6ee7b7;">4. Wild-Caught Large Fish Are Excellent (H = 0.002-0.039)</h3>
            <p>Tuna (H = 0.002) and wild salmon (H = 0.039) are comparable to beef. They have moderate consciousness, relatively natural lives, and low kill counts per meal.</p>
            <p>One large tuna yields 320 portions. One salmon yields 16 portions. Combined with lower consciousness than mammals, these are genuinely low-harm options.</p>
        </div>

        <div class="insight-box">
            <h3 style="margin-top: 0; color: #6ee7b7;">5. Animal Products Are Negligible (H = 0.001-0.013)</h3>
            <p>Eggs (H = 0.007-0.013) and dairy (H = 0.001) have H scores roughly 15-200× better than eating the animals directly. Even battery cage eggs (H=0.013) beat most fish.</p>
            
            <p style="margin-top: 1rem;">This doesn't mean the hens don't suffer—they absolutely do. Battery cage conditions are horrific (L=3.0). But N=0.007 is so tiny that harm per meal barely registers.</p>
            
            <p style="margin-top: 1rem;"><strong>If you're reducing harm but not going vegan, prioritizing products over meat is extremely high-leverage.</strong></p>
        </div>

        <h2>Sanity Checks: Does This Model Make Sense?</h2>

        <p>Before accepting these rankings, we should pressure-test them against other frameworks and intuitions:</p>

        <div class="comparison-grid">
            <div class="comparison-card">
                <div class="comparison-title">Test 1: Directional Agreement with RP</div>
                <p>Rethink Priorities' welfare ranges rank mammals > birds > fish > invertebrates. Our model independently produces the same ordering when comparing within-category averages, despite measuring different things.</p>
                <p style="margin-top: 1em; color: #64748b;">✓ Passes: Same directional structure</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">Test 2: Kill Count Dominance</div>
                <p>Most people initially think chicken is better than beef (smaller minds). The model says beef is 100× better. This follows directly from N=0.0008 vs N=0.096—a parameter you can verify yourself by counting portions.</p>
                <p style="margin-top: 1em; color: #64748b;">✓ Passes: Tractable surprise from explicit math</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">Test 3: The Shrimp Result</div>
                <p>Shrimp being 54× worse than chicken is driven by N=15 overwhelming modest I×T. This is either a crucial insight about aggregation ethics, or it reveals that linear aggregation (γ=1) is wrong. Tune γ to 0.7 and shrimp drops to 6× worse.</p>
                <p style="margin-top: 1em; color: #64748b;">⚠ Mixed: Hinges on γ assumption</p>
            </div>

            <div class="comparison-card">
                <div class="comparison-title">Test 4: Products vs. Meat</div>
                <p>Eggs/dairy being 15-200× better than meat follows from N approaching zero. If you eat 12 eggs per week vs 3 chicken meals, you're consuming 0.024 "chicken equivalents" vs 0.29 chickens. That's a 12× difference in the arithmetic alone.</p>
                <p style="margin-top: 1em; color: #64748b;">✓ Passes: Independently verifiable</p>
            </div>

            <div class="comparison-card">
                <div class="comparison-title">Test 5: Internal Consistency</div>
                <p>Pasture chicken improves over industrial by 34% (0.187 → 0.123) because N stays constant and only L changes. Grass-fed beef improves by 35% (0.002 → 0.001) for the same reason. Sourcing improvements are proportional, as predicted.</p>
                <p style="margin-top: 1em; color: #64748b;">✓ Passes: Internally coherent</p>
            </div>
        </div>

        <div class="insight-box">
            <strong style="color: #6ee7b7;">Net assessment:</strong> The rankings are driven primarily by N (kill count per meal), with consciousness quality (I×T) and welfare conditions (L) as secondary factors. The main uncertainty is γ (aggregation), which is philosophically debatable rather than empirically measurable. Where the model surprises (beef beats chicken, shrimp is catastrophic), the surprises follow from explicit parameters you can inspect and challenge.
        </div>
        
        <h2>Full Data: All Species Evaluated</h2>
        
        <div style="overflow-x: auto; -webkit-overflow-scrolling: touch; margin: 2rem 0;">
        <table id="full-table">
            <thead>
                <tr>
                    <th>Species</th>
                    <th>H</th>
                    <th>Range</th>
                    <th>I</th>
                    <th>T</th>
                    <th>L</th>
                    <th>D_proc</th>
                    <th>D_depr</th>
                    <th>N (per meal)</th>
                    <th>Verdict</th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- Populated by JavaScript -->
            </tbody>
        </table>
        </div>
        
        <p style="font-size: 0.9rem; color: #64748b; margin-top: 1rem; font-style: italic;">* Sentience highly uncertain for these species</p>
        
        <h2>Deeper Questions This Framework Raises</h2>
        
        <p>This model is a tool for structured thinking, not final truth. It surfaces questions that resist easy answers:</p>
        
        <div class="comparison-grid">
            <div class="comparison-card">
                <div class="comparison-title">On Aggregation</div>
                <p>This model assumes suffering scales with numbers raised to γ. But the right value of γ is an open ethical question. Linear aggregation (γ=1.0) treats all suffering as fungible. Diminishing returns (γ<1.0) suggests individual experiences have special weight. Explore this with the γ slider.</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">On Experience Decomposition</div>
                <p>We've split experience into intensity (I) and temporal depth (T), but what if these aren't independent? What if certain types of temporal integration require threshold intensity levels? The I×T product is a simplification.</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">On Suffering Types</div>
                <p>We decompose lifetime suffering into physical, psychological, and social components with separate weights (ω). But are these truly separable? Does chronic physical pain create psychological suffering we're double-counting?</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">On Death</div>
                <p>We've separated death into process (pain of dying) and deprivation (loss of future). But does death harm an animal beyond these? The β and δ weights let you explore this, but the conceptual question remains open.</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">On The Dominance of N</div>
                <p>With default parameters, N explains ~95% of variance in H. Is this model just an elaborate way of saying "count bodies"? Or does it provide value by making that calculation explicit and letting you adjust for consciousness quality?</p>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-title">On Parameter Interactions</div>
                <p>The model assumes I, T, and L components multiply cleanly. But what if suffering isn't compositional this way? What if high physical pain amplifies psychological stress non-linearly? Linear weights might be wrong, but exploring non-linear interactions would make the model intractable.</p>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <div class="closing-reflection">
            <h3 style="margin-top: 0; color: #f1f5f9;">What This Is (and Isn't)</h3>
            <p>This framework emerged from a conversation between Cameron Berg and Claude Sonnet 4.5 about rational diet calibration for people who eat animals but want to minimize harm.</p>
            
            <p style="margin-top: 1rem;">In the US, ~5% of adults are vegetarian and ~3% vegan. Globally, 8-22% depending on region. The vast majority of people eat animals. This is for them.</p>
            
            <p style="margin-top: 1rem;">These estimates are a <strong>reasonable first approximation</strong>, not ground truth. The I and T values draw on empirical research but involve judgment. The L and D scores reflect available welfare data but are coarse. The α, β, δ, γ weights embody one set of commitments, not universal law.</p>
            
            <p style="margin-top: 1rem;">The model's value isn't in complex math—it's in making explicit a calculation most people don't naturally perform: <strong>how many fractional animals am I consuming per meal, adjusted for their consciousness quality and suffering?</strong></p>
            
            <p style="margin-top: 1rem;"><strong>Status:</strong> Useful framework. Not gospel. Can accommodate better data.</p>
        </div>
    </div>
    
    <script>
        const speciesData = [
            {
                species: "Shrimp",
                group: "Seafood",
                I: 0.48, I_low: 0.38, I_high: 0.58,
                T: 0.30, T_low: 0.15, T_high: 0.45,
                L_phys: 1.0, L_psych: 0.8, L_social: 0.7,
                D_process: 3.0, D_deprivation: 0.3,
                N: 15, N_low: 10, N_high: 20,
                description: "15 shrimp per typical serving. Moderate pain capacity, often boiled alive. Low temporal integration but the numbers overwhelm consciousness differences."
            },
            {
                species: "Crab / Lobster",
                group: "Seafood",
                I: 0.45, I_low: 0.35, I_high: 0.55,
                T: 0.35, T_low: 0.20, T_high: 0.50,
                L_phys: 0.7, L_psych: 0.6, L_social: 0.2,
                D_process: 3.0, D_deprivation: 0.5,
                N: 0.5, N_low: 0.4, N_high: 0.6,
                description: "One crab/lobster yields ~2 meals. Often boiled alive, complex nociception. Evidence of pain learning and memory."
            },
            {
                species: "Small Fish (Anchovy, Sardine)",
                group: "Seafood",
                I: 0.50, I_low: 0.35, I_high: 0.65,
                T: 0.35, T_low: 0.20, T_high: 0.50,
                L_phys: 0.3, L_psych: 0.3, L_social: 0.1,
                D_process: 2.0, D_deprivation: 0.5,
                N: 5, N_low: 4, N_high: 7,
                description: "~5 small fish per meal. Wild-caught, massive trawl deaths. Natural lives but violent deaths."
            },
            {
                species: "Chicken - Industrial",
                group: "Bird",
                I: 0.70, I_low: 0.60, I_high: 0.80,
                T: 0.60, T_low: 0.50, T_high: 0.70,
                L_phys: 1.2, L_psych: 0.8, L_social: 0.8,
                D_process: 2.0, D_deprivation: 1.5,
                N: 0.096, N_low: 0.08, N_high: 0.11,
                description: "One chicken yields ~10 portions (5oz each). Fast growth breeds, extreme confinement, chronic pain from genetics. One of the worst poultry options."
            },
            {
                species: "Chicken - Pasture-Raised",
                group: "Bird",
                I: 0.70, I_low: 0.60, I_high: 0.80,
                T: 0.60, T_low: 0.50, T_high: 0.70,
                L_phys: 0.4, L_psych: 0.4, L_social: 0.4,
                D_process: 2.0, D_deprivation: 1.5,
                N: 0.096, N_low: 0.08, N_high: 0.11,
                description: "Natural behaviors, outdoor access, less chronic suffering. Same minds as industrial, better lives. Still N=0.096 per portion."
            },
            {
                species: "Eggs - Battery Cage",
                group: "Products",
                I: 0.70, I_low: 0.60, I_high: 0.80,
                T: 0.60, T_low: 0.50, T_high: 0.70,
                L_phys: 1.3, L_psych: 0.9, L_social: 0.8,
                D_process: 1.5, D_deprivation: 1.5,
                N: 0.007, N_low: 0.006, N_high: 0.009,
                description: "2 eggs per meal, hen lays ~300/year = 150 meals per hen. Extreme confinement stress + male chick culling, but tiny N makes harm per meal low."
            },
            {
                species: "Eggs - Pasture-Raised",
                group: "Products",
                I: 0.70, I_low: 0.60, I_high: 0.80,
                T: 0.60, T_low: 0.50, T_high: 0.70,
                L_phys: 0.3, L_psych: 0.3, L_social: 0.2,
                D_process: 1.5, D_deprivation: 1.5,
                N: 0.007, N_low: 0.006, N_high: 0.009,
                description: "Natural behaviors, outdoor access, minimal culling if small-scale. Among the lowest-harm animal foods."
            },
            {
                species: "Turkey - Industrial",
                group: "Bird",
                I: 0.72, I_low: 0.62, I_high: 0.82,
                T: 0.62, T_low: 0.52, T_high: 0.72,
                L_phys: 1.1, L_psych: 0.7, L_social: 0.7,
                D_process: 2.0, D_deprivation: 1.5,
                N: 0.028, N_low: 0.025, N_high: 0.035,
                description: "One turkey yields ~36 portions. Similar welfare issues to industrial chicken, but much better N due to size."
            },
            {
                species: "Duck",
                group: "Bird",
                I: 0.73, I_low: 0.63, I_high: 0.83,
                T: 0.63, T_low: 0.53, T_high: 0.73,
                L_phys: 0.8, L_psych: 0.5, L_social: 0.5,
                D_process: 2.0, D_deprivation: 1.5,
                N: 0.11, N_low: 0.09, N_high: 0.13,
                description: "One duck yields ~9 portions. Often raised in better conditions than chickens. Evidence of social learning and bonds."
            },
            {
                species: "Octopus",
                group: "Seafood",
                I: 0.75, I_low: 0.60, I_high: 0.90,
                T: 0.70, T_low: 0.55, T_high: 0.85,
                L_phys: 0.5, L_psych: 0.4, L_social: 0.1,
                D_process: 2.5, D_deprivation: 2.0,
                N: 0.13, N_low: 0.10, N_high: 0.16,
                description: "One octopus yields ~8 portions. Highly intelligent, complex problem-solving, mostly wild-caught. Distributed nervous system creates uncertainty."
            },
            {
                species: "Pig - Industrial",
                group: "Mammal",
                I: 0.85, I_low: 0.75, I_high: 0.95,
                T: 0.95, T_low: 0.85, T_high: 1.00,
                L_phys: 0.8, L_psych: 0.6, L_social: 1.0,
                D_process: 1.5, D_deprivation: 2.5,
                N: 0.002, N_low: 0.0015, N_high: 0.0025,
                description: "One pig yields ~538 portions. Highly intelligent, strong social bonds, often confined. Rich temporal integration - but tiny N overwhelms welfare concerns."
            },
            {
                species: "Beef - Feedlot",
                group: "Mammal",
                I: 0.80, I_low: 0.70, I_high: 0.90,
                T: 0.85, T_low: 0.75, T_high: 0.95,
                L_phys: 0.5, L_psych: 0.3, L_social: 0.7,
                D_process: 1.0, D_deprivation: 2.5,
                N: 0.0008, N_low: 0.0006, N_high: 0.001,
                description: "One cow yields ~1280 portions. Rich conscious lives, but enormous size = incredibly low kill count. Some confinement stress."
            },
            {
                species: "Beef - Grass-Fed",
                group: "Mammal",
                I: 0.80, I_low: 0.70, I_high: 0.90,
                T: 0.85, T_low: 0.75, T_high: 0.95,
                L_phys: 0.2, L_psych: 0.2, L_social: 0.3,
                D_process: 1.0, D_deprivation: 2.5,
                N: 0.0008, N_low: 0.0006, N_high: 0.001,
                description: "Natural grazing, minimal confinement, same incredibly low kill count. One of the best mammal options."
            },
            {
                species: "Dairy - Factory",
                group: "Products",
                I: 0.80, I_low: 0.70, I_high: 0.90,
                T: 0.85, T_low: 0.75, T_high: 0.95,
                L_phys: 1.0, L_psych: 0.7, L_social: 0.8,
                D_process: 1.0, D_deprivation: 2.5,
                N: 0.0005, N_low: 0.0004, N_high: 0.0006,
                description: "1 cup milk per meal, cow produces ~48,000 cups/year (accounting for culling). Chronic mastitis, repeated pregnancy/separation. But N is tiny."
            },
            {
                species: "Dairy - Pasture",
                group: "Products",
                I: 0.80, I_low: 0.70, I_high: 0.90,
                T: 0.85, T_low: 0.75, T_high: 0.95,
                L_phys: 0.3, L_psych: 0.3, L_social: 0.4,
                D_process: 1.0, D_deprivation: 2.5,
                N: 0.0005, N_low: 0.0004, N_high: 0.0006,
                description: "Grazing access, better health, still some calf separation. Much better than factory."
            },
            {
                species: "Salmon - Farmed",
                group: "Seafood",
                I: 0.55, I_low: 0.45, I_high: 0.65,
                T: 0.45, T_low: 0.35, T_high: 0.55,
                L_phys: 0.9, L_psych: 0.7, L_social: 0.2,
                D_process: 2.0, D_deprivation: 1.0,
                N: 0.0625, N_low: 0.05, N_high: 0.08,
                description: "One salmon yields ~16 portions. Sea lice, crowding, lesions, restricted movement. Pain affects feeding and behavior."
            },
            {
                species: "Salmon - Wild",
                group: "Seafood",
                I: 0.55, I_low: 0.45, I_high: 0.65,
                T: 0.45, T_low: 0.35, T_high: 0.55,
                L_phys: 0.3, L_psych: 0.3, L_social: 0.2,
                D_process: 2.0, D_deprivation: 1.0,
                N: 0.0625, N_low: 0.05, N_high: 0.08,
                description: "Natural life, migrations, predation stress but freedom. One of the better seafood options."
            },
            {
                species: "Tilapia - Farmed",
                group: "Seafood",
                I: 0.48, I_low: 0.38, I_high: 0.58,
                T: 0.38, T_low: 0.28, T_high: 0.48,
                L_phys: 0.9, L_psych: 0.8, L_social: 0.1,
                D_process: 2.0, D_deprivation: 0.8,
                N: 0.37, N_low: 0.30, N_high: 0.45,
                description: "One tilapia yields ~3 portions. High-density farming, poor water quality. Stress responses visible in cortisol levels."
            },
            {
                species: "Catfish",
                group: "Seafood",
                I: 0.50, I_low: 0.40, I_high: 0.60,
                T: 0.40, T_low: 0.30, T_high: 0.50,
                L_phys: 0.7, L_psych: 0.7, L_social: 0.1,
                D_process: 2.0, D_deprivation: 0.8,
                N: 0.28, N_low: 0.22, N_high: 0.35,
                description: "One catfish yields ~4 portions. Similar to tilapia farming conditions, some evidence of social learning."
            },
            {
                species: "Cod / Whitefish",
                group: "Seafood",
                I: 0.52, I_low: 0.42, I_high: 0.62,
                T: 0.42, T_low: 0.32, T_high: 0.52,
                L_phys: 0.4, L_psych: 0.4, L_social: 0.1,
                D_process: 2.0, D_deprivation: 1.0,
                N: 0.21, N_low: 0.17, N_high: 0.25,
                description: "One cod yields ~5 portions. Usually wild-caught, moderate welfare. Evidence of pain avoidance learning."
            },
            {
                species: "Tuna - Large",
                group: "Seafood",
                I: 0.58, I_low: 0.48, I_high: 0.68,
                T: 0.48, T_low: 0.38, T_high: 0.58,
                L_phys: 0.3, L_psych: 0.3, L_social: 0.1,
                D_process: 2.0, D_deprivation: 1.2,
                N: 0.003, N_low: 0.002, N_high: 0.004,
                description: "One large tuna yields ~320 portions. Wild-caught, enormous individuals, very low kill count. One of the best seafood options."
            },
            {
                species: "Honey - Industrial",
                group: "Products",
                I: 0.20, I_low: 0.10, I_high: 0.30,
                T: 0.15, T_low: 0.05, T_high: 0.25,
                L_phys: 0.6, L_psych: 0.6, L_social: 0.3,
                D_process: 0.3, D_deprivation: 0.1,
                N: 0.001, N_low: 0.0008, N_high: 0.0012,
                description: "Hive stress, queen clipping, disease. Evidence of learning but integration unclear. Very low N."
            },
            {
                species: "Honey - Small-Scale",
                group: "Products",
                I: 0.20, I_low: 0.10, I_high: 0.30,
                T: 0.15, T_low: 0.05, T_high: 0.25,
                L_phys: 0.2, L_psych: 0.2, L_social: 0.1,
                D_process: 0.3, D_deprivation: 0.1,
                N: 0.001, N_low: 0.0008, N_high: 0.0012,
                description: "Better hive management, less stress. Bees exhibit decision-making but sentience uncertain."
            },
            {
                species: "Mussels / Oysters*",
                group: "Frontier",
                I: 0.15, I_low: 0.05, I_high: 0.25,
                T: 0.10, T_low: 0.02, T_high: 0.18,
                L_phys: 0.1, L_psych: 0.1, L_social: 0.0,
                D_process: 0.5, D_deprivation: 0.1,
                N: 8, N_low: 6, N_high: 12,
                description: "~8 bivalves per meal. Minimal nervous system, mostly reflex. Sentience highly uncertain."
            },
            {
                species: "Insects (Crickets, Mealworms)*",
                group: "Frontier",
                I: 0.12, I_low: 0.05, I_high: 0.20,
                T: 0.08, T_low: 0.02, T_high: 0.15,
                L_phys: 0.3, L_psych: 0.2, L_social: 0.0,
                D_process: 0.5, D_deprivation: 0.1,
                N: 50, N_low: 40, N_high: 70,
                description: "~50 insects per meal. Nociception present but integration unclear. Sentience uncertain - precautionary approach warrants caution."
            }
        ];
        
        let currentFilter = 'all';
        let selectedSpecies = null;
        let chart = null;
        let useLogScale = false;
        let showUncertainty = false;
        
        function calculateL(data, omega_phys, omega_psych, omega_social) {
            return omega_phys * data.L_phys + omega_psych * data.L_psych + omega_social * data.L_social;
        }
        
        function calculateH(data, alpha, beta, delta, gamma, omega_phys, omega_psych, omega_social, useRange = false) {
            const results = data.map(d => {
                const L = calculateL(d, omega_phys, omega_psych, omega_social);
                
                if (useRange) {
                    const I_vals = [d.I_low, d.I, d.I_high];
                    const T_vals = [d.T_low, d.T, d.T_high];
                    const N_vals = [d.N_low, d.N, d.N_high];
                    
                    const H_low = Math.pow(N_vals[0], gamma) * I_vals[0] * T_vals[0] * 
                        (alpha * L * 0.8 + beta * d.D_process * 0.8 + delta * d.D_deprivation * 0.8);
                    const H_central = Math.pow(N_vals[1], gamma) * I_vals[1] * T_vals[1] * 
                        (alpha * L + beta * d.D_process + delta * d.D_deprivation);
                    const H_high = Math.pow(N_vals[2], gamma) * I_vals[2] * T_vals[2] * 
                        (alpha * L * 1.2 + beta * d.D_process * 1.2 + delta * d.D_deprivation * 1.2);
                    
                    return {
                        ...d,
                        L: L,
                        H: H_central,
                        H_low: H_low,
                        H_high: H_high
                    };
                } else {
                    const H = Math.pow(d.N, gamma) * d.I * d.T * 
                        (alpha * L + beta * d.D_process + delta * d.D_deprivation);
                    
                    return {
                        ...d,
                        L: L,
                        H: H
                    };
                }
            }).sort((a, b) => b.H - a.H);
            
            return results;
        }
        
        function getFilteredData(data) {
            if (currentFilter === 'all') return data;
            return data.filter(d => d.group === currentFilter);
        }
        
        function updateVisualization() {
            const alpha = parseFloat(document.getElementById('alpha-slider').value);
            const beta = parseFloat(document.getElementById('beta-slider').value);
            const delta = parseFloat(document.getElementById('delta-slider').value);
            const gamma = parseFloat(document.getElementById('gamma-slider').value);
            const omega_phys = parseFloat(document.getElementById('omega-phys-slider').value);
            const omega_psych = parseFloat(document.getElementById('omega-psych-slider').value);
            const omega_social = parseFloat(document.getElementById('omega-social-slider').value);
            
            document.getElementById('alpha-value').textContent = alpha.toFixed(1);
            document.getElementById('beta-value').textContent = beta.toFixed(1);
            document.getElementById('delta-value').textContent = delta.toFixed(1);
            document.getElementById('gamma-value').textContent = gamma.toFixed(1);
            document.getElementById('omega-phys-value').textContent = omega_phys.toFixed(1);
            document.getElementById('omega-psych-value').textContent = omega_psych.toFixed(1);
            document.getElementById('omega-social-value').textContent = omega_social.toFixed(1);
            
            const results = calculateH(speciesData, alpha, beta, delta, gamma, omega_phys, omega_psych, omega_social, showUncertainty);
            const filtered = getFilteredData(results);
            
            updateChart(filtered);
            updateTable(results);
            
            if (selectedSpecies) {
                const species = results.find(d => d.species === selectedSpecies);
                if (species) {
                    showDetailPanel(species);
                }
            }
        }
        
        function updateChart(data) {
            const ctx = document.getElementById('harmChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }
            
            const scaleConfig = useLogScale ? {
                type: 'logarithmic',
                min: 0.0001,
                ticks: { 
                    color: '#94a3b8',
                    callback: function(value) {
                        if (value === 0.0001 || value === 0.001 || value === 0.01 || value === 0.1 || value === 1 || value === 10 || value === 100) {
                            return value;
                        }
                        return '';
                    }
                },
                title: {
                    display: true,
                    text: 'H (log scale)',
                    color: '#94a3b8'
                }
            } : {
                type: 'linear',
                ticks: { 
                    color: '#94a3b8'
                },
                title: {
                    display: true,
                    text: 'H',
                    color: '#94a3b8'
                }
            };
            
            const datasets = [{
                label: 'Harm per Meal',
                data: data.map(d => d.H),
                backgroundColor: data.map(d => {
                    if (d.H > 10) return '#7f1d1d';
                    if (d.H > 5) return '#991b1b';
                    if (d.H > 2) return '#dc2626';
                    if (d.H > 1) return '#f97316';
                    if (d.H > 0.5) return '#f59e0b';
                    if (d.H > 0.2) return '#eab308';
                    if (d.H > 0.1) return '#84cc16';
                    if (d.H > 0.01) return '#22c55e';
                    return '#10b981';
                }),
                borderRadius: 8,
                borderSkipped: false
            }];
            
            if (showUncertainty) {
                datasets.push({
                    label: 'Lower Bound',
                    data: data.map(d => d.H_low || d.H * 0.6),
                    backgroundColor: 'rgba(148, 163, 184, 0.3)',
                    borderRadius: 8,
                    borderSkipped: false
                });
                datasets.push({
                    label: 'Upper Bound',
                    data: data.map(d => d.H_high || d.H * 1.4),
                    backgroundColor: 'rgba(148, 163, 184, 0.3)',
                    borderRadius: 8,
                    borderSkipped: false
                });
            }
            
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(d => d.species),
                    datasets: datasets
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            selectedSpecies = data[index].species;
                            showDetailPanel(data[index]);
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#0f172a',
                            borderColor: '#334155',
                            borderWidth: 1,
                            titleColor: '#e2e8f0',
                            bodyColor: '#cbd5e1',
                            callbacks: {
                                label: (context) => {
                                    if (context.datasetIndex === 0) {
                                        return `H = ${context.parsed.x.toFixed(3)}`;
                                    }
                                    return '';
                                },
                                afterLabel: (context) => {
                                    if (context.datasetIndex === 0) {
                                        const d = data[context.dataIndex];
                                        if (showUncertainty && d.H_low && d.H_high) {
                                            return `Range: [${d.H_low.toFixed(3)} - ${d.H_high.toFixed(3)}]`;
                                        }
                                    }
                                    return '';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ...scaleConfig,
                            grid: { color: '#1e293b' }
                        },
                        y: {
                            grid: { display: false },
                            ticks: { 
                                color: '#cbd5e1',
                                font: { size: 11 }
                            }
                        }
                    }
                }
            });
        }
        
        function updateTable(data) {
            const tbody = document.getElementById('table-body');
            
            let html = '';
            
            data.forEach((d, index) => {
                let verdict = 'Moderate';
                if (d.H >= 10) verdict = 'Catastrophic';
                else if (d.H >= 5) verdict = 'Very High';
                else if (d.H >= 2) verdict = 'High';
                else if (d.H >= 1) verdict = 'Moderate-High';
                else if (d.H >= 0.5) verdict = 'Moderate';
                else if (d.H >= 0.2) verdict = 'Moderate-Low';
                else if (d.H >= 0.1) verdict = 'Low';
                else if (d.H >= 0.01) verdict = 'Very Low';
                else verdict = 'Negligible';
                
                let bgColor;
                if (d.H >= 10) {
                    bgColor = '#7f1d1d';
                } else if (d.H >= 5) {
                    bgColor = '#991b1b';
                } else if (d.H >= 2) {
                    bgColor = '#dc2626';
                } else if (d.H >= 1) {
                    bgColor = '#f97316';
                } else if (d.H >= 0.5) {
                    bgColor = '#f59e0b';
                } else if (d.H >= 0.2) {
                    bgColor = '#eab308';
                } else if (d.H >= 0.1) {
                    bgColor = '#84cc16';
                } else if (d.H >= 0.01) {
                    bgColor = '#22c55e';
                } else {
                    bgColor = '#10b981';
                }
                
                const rangeStr = (d.H_low && d.H_high) ? 
                    `[${d.H_low.toFixed(3)} - ${d.H_high.toFixed(3)}]` : 
                    '—';
                
                html += `
                    <tr style="background: ${bgColor};">
                        <td><strong>${d.species}</strong></td>
                        <td><strong>${d.H.toFixed(3)}</strong></td>
                        <td style="font-size: 0.85em; color: #94a3b8;">${rangeStr}</td>
                        <td>${d.I.toFixed(2)}</td>
                        <td>${d.T.toFixed(2)}</td>
                        <td>${d.L.toFixed(1)}</td>
                        <td>${d.D_process.toFixed(1)}</td>
                        <td>${d.D_deprivation.toFixed(1)}</td>
                        <td>${d.N.toFixed(4)}</td>
                        <td>${verdict}</td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        function showDetailPanel(data) {
            document.getElementById('detail-panel').style.display = 'block';
            document.getElementById('detail-species-name').textContent = data.species;
            document.getElementById('detail-h').textContent = data.H.toFixed(3);
            
            if (data.H_low && data.H_high) {
                document.getElementById('detail-range').textContent = 
                    `[${data.H_low.toFixed(3)} - ${data.H_high.toFixed(3)}]`;
            } else {
                document.getElementById('detail-range').textContent = '';
            }
            
            document.getElementById('detail-group').textContent = data.group;
            document.getElementById('detail-I').textContent = data.I.toFixed(2);
            document.getElementById('detail-T').textContent = data.T.toFixed(2);
            document.getElementById('detail-L').textContent = data.L.toFixed(1);
            document.getElementById('detail-D-process').textContent = data.D_process.toFixed(1);
            document.getElementById('detail-D-deprivation').textContent = data.D_deprivation.toFixed(1);
            document.getElementById('detail-N').textContent = data.N.toFixed(4);
            document.getElementById('detail-L-phys').textContent = data.L_phys.toFixed(1);
            document.getElementById('detail-L-psych').textContent = data.L_psych.toFixed(1);
            document.getElementById('detail-L-social').textContent = data.L_social.toFixed(1);
            document.getElementById('detail-description').textContent = data.description || '';
            
            document.getElementById('detail-panel').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Event listeners
        document.getElementById('alpha-slider').addEventListener('input', updateVisualization);
        document.getElementById('beta-slider').addEventListener('input', updateVisualization);
        document.getElementById('delta-slider').addEventListener('input', updateVisualization);
        document.getElementById('gamma-slider').addEventListener('input', updateVisualization);
        document.getElementById('omega-phys-slider').addEventListener('input', updateVisualization);
        document.getElementById('omega-psych-slider').addEventListener('input', updateVisualization);
        document.getElementById('omega-social-slider').addEventListener('input', updateVisualization);
        
        document.getElementById('scale-toggle').addEventListener('click', () => {
            useLogScale = !useLogScale;
            document.getElementById('scale-toggle').textContent = useLogScale ? 'Switch to Linear Scale' : 'Switch to Log Scale';
            updateVisualization();
        });
        
        document.getElementById('uncertainty-toggle').addEventListener('click', () => {
            showUncertainty = !showUncertainty;
            document.getElementById('uncertainty-toggle').textContent = showUncertainty ? 'Hide Uncertainty' : 'Show Uncertainty';
            updateVisualization();
        });
        
        document.querySelectorAll('.filter-pill').forEach(pill => {
            pill.addEventListener('click', () => {
                document.querySelectorAll('.filter-pill').forEach(p => p.classList.remove('active'));
                pill.classList.add('active');
                currentFilter = pill.dataset.group;
                updateVisualization();
            });
        });
        
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const preset = btn.dataset.preset;
                if (preset === 'balanced') {
                    document.getElementById('omega-phys-slider').value = 1.0;
                    document.getElementById('omega-psych-slider').value = 1.0;
                    document.getElementById('omega-social-slider').value = 1.0;
                } else if (preset === 'physical') {
                    document.getElementById('omega-phys-slider').value = 1.5;
                    document.getElementById('omega-psych-slider').value = 0.5;
                    document.getElementById('omega-social-slider').value = 0.5;
                } else if (preset === 'social') {
                    document.getElementById('omega-phys-slider').value = 0.5;
                    document.getElementById('omega-psych-slider').value = 0.5;
                    document.getElementById('omega-social-slider').value = 1.5;
                }
                updateVisualization();
            });
        });
        
        // Initialize
        updateVisualization();
    </script>
</body>
</html>
